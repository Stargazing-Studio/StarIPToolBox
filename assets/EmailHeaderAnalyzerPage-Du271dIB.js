import{u as I,r as g,j as e,l as x,m as v,n as R,o as S,p as F}from"./index-pePUiUqb.js";const C=()=>{const{t:a}=I(),[j,N]=g.useState(""),[r,u]=g.useState(null),[w,b]=g.useState(null),o=(s,t)=>{const i=new RegExp(`^${t}:\\s*(.+)$`,"im");for(let l=0;l<s.length;l++){const d=s[l].match(i);if(d){let n=d[1];for(let c=l+1;c<s.length&&s[c].match(/^\s+/);c++)n+=" "+s[c].trim();return n.trim()}}return""},y=s=>{const t=/\b(?:\d{1,3}\.){3}\d{1,3}\b/g,i=s.match(t)||[];return[...new Set(i)].filter(l=>l.split(".").every(n=>parseInt(n)<=255))},z=s=>{const t=[],i=/^Received:\s*/i;for(let l=0;l<s.length;l++)if(i.test(s[l])){let d=s[l].replace(i,"");for(let h=l+1;h<s.length&&s[h].match(/^\s+/);h++)d+=" "+s[h].trim();const n=d.match(/from\s+([^\s;]+)/i),c=d.match(/by\s+([^\s;]+)/i),p=d.match(/;\s*(.+)$/);(n||c)&&t.push({from:n?n[1]:a("pages.emailHeaderAnalyzer.results.unknown"),by:c?c[1]:a("pages.emailHeaderAnalyzer.results.unknown"),date:p?p[1].trim():""})}return t.reverse()},k=()=>{const s=j.trim();if(!s){b(a("pages.emailHeaderAnalyzer.errors.empty")),u(null);return}try{const t=s.split(`
`),i=o(t,"From"),l=o(t,"To"),d=o(t,"Subject"),n=o(t,"Date"),c=o(t,"Message-ID"),p=o(t,"Return-Path"),h=o(t,"Received-SPF"),A=o(t,"DKIM-Signature"),H=o(t,"Authentication-Results"),f=z(t),P=y(s);if(!i&&!l&&f.length===0){b(a("pages.emailHeaderAnalyzer.errors.invalid")),u(null);return}u({from:i,to:l,subject:d,date:n,messageId:c,returnPath:p,receivedPath:f,spf:h,dkim:A,dmarc:H,sourceIPs:P}),b(null)}catch{b(a("pages.emailHeaderAnalyzer.errors.parsing")),u(null)}},m=(s,t,i)=>i?e.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-sky-400 mt-1 flex-shrink-0",children:s}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-white/60 font-medium mb-1",children:t}),e.jsx("div",{className:"text-white break-all text-sm",children:i})]})]})}):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-2xl p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:a("pages.emailHeaderAnalyzer.title")}),e.jsx("p",{className:"text-white/80 text-sm mb-6",children:a("pages.emailHeaderAnalyzer.description")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:a("pages.emailHeaderAnalyzer.input.label")}),e.jsx("textarea",{value:j,onChange:s=>N(s.target.value),placeholder:a("pages.emailHeaderAnalyzer.input.placeholder"),rows:10,className:"w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-sky-400 transition-all font-mono text-sm resize-vertical"})]}),e.jsx("button",{onClick:k,className:"w-full bg-gradient-to-r from-sky-400 to-blue-500 hover:from-sky-500 hover:to-blue-600 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl",children:a("pages.emailHeaderAnalyzer.actions.analyze")}),w&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-red-400 text-sm",children:w})})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-2xl p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:a("pages.emailHeaderAnalyzer.results.basicInfo")}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[m(e.jsx(x,{size:20}),a("pages.emailHeaderAnalyzer.results.from"),r.from),m(e.jsx(x,{size:20}),a("pages.emailHeaderAnalyzer.results.to"),r.to),m(e.jsx(x,{size:20}),a("pages.emailHeaderAnalyzer.results.subject"),r.subject),m(e.jsx(v,{size:20}),a("pages.emailHeaderAnalyzer.results.date"),r.date),m(e.jsx(x,{size:20}),a("pages.emailHeaderAnalyzer.results.messageId"),r.messageId),m(e.jsx(x,{size:20}),a("pages.emailHeaderAnalyzer.results.returnPath"),r.returnPath)]})]}),r.receivedPath.length>0&&e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-2xl p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:a("pages.emailHeaderAnalyzer.results.path")}),e.jsx("div",{className:"space-y-3",children:r.receivedPath.map((s,t)=>e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10 relative",children:[e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-sky-400 to-blue-500 rounded-l-lg"}),e.jsxs("div",{className:"pl-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(R,{size:16,className:"text-sky-400"}),e.jsxs("span",{className:"text-white/60 text-sm font-medium",children:[a("pages.emailHeaderAnalyzer.results.hop")," ",t+1]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"text-white",children:[e.jsxs("span",{className:"text-white/60",children:[a("pages.emailHeaderAnalyzer.results.fromServer"),":"," "]}),e.jsx("span",{className:"font-mono",children:s.from})]}),e.jsxs("div",{className:"text-white",children:[e.jsxs("span",{className:"text-white/60",children:[a("pages.emailHeaderAnalyzer.results.byServer"),":"," "]}),e.jsx("span",{className:"font-mono",children:s.by})]}),s.date&&e.jsxs("div",{className:"text-white/60",children:[e.jsx(v,{size:14,className:"inline mr-1 mb-0.5"}),s.date]})]})]})]},t))})]}),r.sourceIPs.length>0&&e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-2xl p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:a("pages.emailHeaderAnalyzer.results.sourceIPs")}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:r.sourceIPs.map((s,t)=>e.jsx("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{size:16,className:"text-sky-400"}),e.jsx("span",{className:"text-white font-mono text-sm",children:s})]})},t))})]}),(r.spf||r.dkim||r.dmarc)&&e.jsxs("div",{className:"bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-2xl p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(F,{size:20}),a("pages.emailHeaderAnalyzer.results.authentication")]}),e.jsxs("div",{className:"space-y-3",children:[r.spf&&e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("div",{className:"text-sm text-white/60 font-medium mb-1",children:"SPF"}),e.jsx("div",{className:"text-white text-sm font-mono break-all",children:r.spf})]}),r.dkim&&e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("div",{className:"text-sm text-white/60 font-medium mb-1",children:"DKIM"}),e.jsxs("div",{className:"text-white text-sm font-mono break-all",children:[r.dkim.substring(0,200),r.dkim.length>200&&"..."]})]}),r.dmarc&&e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("div",{className:"text-sm text-white/60 font-medium mb-1",children:"DMARC / Authentication Results"}),e.jsx("div",{className:"text-white text-sm font-mono break-all",children:r.dmarc})]})]})]})]})]})};export{C as default};
