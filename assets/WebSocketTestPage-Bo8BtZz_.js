import{r as n,u as j,j as e,e as y,f as T,g as v,h as N}from"./index-pePUiUqb.js";const E=()=>{const[d,x]=n.useState("wss://echo.websocket.org"),[c,m]=n.useState(!1),[i,u]=n.useState(""),[l,b]=n.useState([]),o=n.useRef(null),g=n.useRef(null),{t}=j();n.useEffect(()=>()=>{o.current&&o.current.close()},[]),n.useEffect(()=>{var s;(s=g.current)==null||s.scrollIntoView({behavior:"smooth"})},[l]);const a=(s,r)=>{b(k=>[...k,{type:s,content:r,timestamp:new Date}])},p=()=>{try{if(c&&o.current){o.current.close();return}const s=new WebSocket(d);s.onopen=()=>{m(!0),a("system",t("pages.websocketTest.messages.connectionSuccess")),o.current=s},s.onmessage=r=>{a("received",r.data)},s.onerror=r=>{a("system",t("pages.websocketTest.messages.connectionError")),console.error("WebSocket error:",r)},s.onclose=()=>{m(!1),a("system",t("pages.websocketTest.messages.connectionClosed")),o.current=null}}catch(s){const r=s instanceof Error&&s.message?s.message:t("pages.websocketTest.messages.unknownError");a("system",t("pages.websocketTest.messages.connectionFailed",{error:r}))}},h=()=>{!i.trim()||!o.current||o.current.readyState!==WebSocket.OPEN||(o.current.send(i),a("sent",i),u(""))},w=()=>{b([])},f=[t("pages.websocketTest.instructions.step1"),t("pages.websocketTest.instructions.step2"),t("pages.websocketTest.instructions.step3"),t("pages.websocketTest.instructions.step4"),t("pages.websocketTest.instructions.step5")];return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 p-6 sm:p-8",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-white mb-6",children:t("pages.websocketTest.title")}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:t("pages.websocketTest.form.urlLabel")}),e.jsx("input",{type:"text",className:"w-full bg-white/10 backdrop-blur-sm rounded-lg p-3 text-sm border border-white/30 focus:ring-2 focus:ring-sky-400 focus:border-sky-400 focus:outline-none transition text-white placeholder:text-white/70",placeholder:t("pages.websocketTest.form.urlPlaceholder"),value:d,onChange:s=>x(s.target.value),disabled:c})]}),e.jsx("button",{onClick:p,className:`w-full font-bold py-3 px-4 rounded-lg transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-2 ${c?"bg-red-500 hover:bg-red-600 text-white":"bg-gradient-to-r from-sky-400 to-white text-slate-800 hover:opacity-90"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(y,{}),t("pages.websocketTest.actions.disconnect")]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{}),t("pages.websocketTest.actions.connect")]})})]})]}),c&&e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 p-6 sm:p-8 animate-slide-in-up",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:t("pages.websocketTest.messages.sectionTitle")}),e.jsx("button",{onClick:w,className:"p-2 bg-white/10 hover:bg-white/20 rounded-lg transition text-white",title:t("pages.websocketTest.actions.clearMessages"),children:e.jsx(v,{})})]}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 h-64 overflow-y-auto mb-4 space-y-2",children:[l.length===0?e.jsx("p",{className:"text-white/60 text-sm text-center py-8",children:t("pages.websocketTest.messages.empty")}):l.map((s,r)=>e.jsxs("div",{className:`p-3 rounded-lg ${s.type==="sent"?"bg-sky-500/20 ml-auto max-w-[80%]":s.type==="received"?"bg-green-500/20 mr-auto max-w-[80%]":"bg-white/10 text-center"}`,children:[e.jsx("p",{className:"text-white text-sm break-all",children:s.content}),e.jsx("p",{className:"text-white/50 text-xs mt-1",children:s.timestamp.toLocaleTimeString()})]},r)),e.jsx("div",{ref:g})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"flex-1 bg-white/10 backdrop-blur-sm rounded-lg p-3 text-sm border border-white/30 focus:ring-2 focus:ring-sky-400 focus:border-sky-400 focus:outline-none transition text-white placeholder:text-white/70",placeholder:t("pages.websocketTest.inputs.messagePlaceholder"),value:i,onChange:s=>u(s.target.value),onKeyPress:s=>s.key==="Enter"&&h()}),e.jsxs("button",{onClick:h,disabled:!i.trim(),className:"bg-gradient-to-r from-sky-400 to-white text-slate-800 font-bold py-3 px-6 rounded-lg hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center gap-2",children:[e.jsx(N,{}),t("pages.websocketTest.actions.send")]})]})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl shadow-2xl border border-white/20 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:t("pages.websocketTest.instructions.title")}),e.jsx("ul",{className:"text-white/80 text-sm space-y-2 list-disc list-inside",children:f.map((s,r)=>e.jsx("li",{children:s},r))})]})]})};export{E as default};
